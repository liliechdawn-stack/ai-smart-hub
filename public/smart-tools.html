<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Smart Business Hub | AI Intelligence Center</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Load scripts in correct order -->
    <script src="js/config.js"></script>
    <script src="js/master-fix.js"></script>
    <script src="js/fix-all-html.js"></script>
    
    <style>
        /* ========================================
           CORE DESIGN TOKENS
           ========================================
        */
        :root {
          --primary: #d4af37;
          --primary-hover: #b8962e;
          --dark: #1a1a1a;
          --dark-accent: #2d2d2d;
          --light: #f8f9fa;
          --success: #28a745;
          --danger: #dc3545;
          --border-color: #eee;
          --shadow: 0 10px 30px rgba(0,0,0,0.08);
          --card-radius: 16px;
          --transition: 0.3s ease;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }
        
        body { 
          font-family: 'Inter', sans-serif; 
          background: #f4f7f6; 
          color: var(--dark); 
          line-height: 1.6; 
          overflow-x: hidden;
        }

        /* ========================================
           NAVIGATION BAR
           ========================================
        */
        nav {
          background: #fff;
          padding: 15px 0;
          border-bottom: 1px solid var(--border-color);
          position: sticky;
          top: 0;
          z-index: 1000;
          box-shadow: 0 2px 10px rgba(0,0,0,0.02);
        }
        
        .nav-container { 
          max-width: 1200px; 
          margin: 0 auto; 
          display: flex; 
          justify-content: space-between; 
          align-items: center; 
          padding: 0 20px; 
        }
        
        .nav-logo { 
          font-weight: 700; 
          font-size: 1.2rem; 
          color: var(--dark); 
          text-decoration: none; 
          display: flex; 
          align-items: center; 
          gap: 8px; 
        }
        
        .nav-links { 
          display: flex; 
          gap: 20px; 
          align-items: center; 
        }
        
        .nav-links a { 
          text-decoration: none; 
          color: #666; 
          font-size: 0.9rem; 
          font-weight: 500; 
          transition: var(--transition); 
        }
        
        .nav-links a:hover { 
          color: var(--primary); 
        }
        
        .active-nav { 
          color: var(--primary) !important; 
          border-bottom: 2px solid var(--primary); 
        }
        
        .back-btn { 
          background: var(--dark); 
          color: #fff !important; 
          padding: 8px 18px; 
          border-radius: 8px; 
          font-weight: 600;
        }

        /* ========================================
           PLAN LOCKING & UPGRADE SYSTEM
           ========================================
        */
        .locked-card { 
          position: relative; 
          overflow: hidden; 
          border-color: #ddd !important; 
        }
        
        .lock-overlay {
          position: absolute; 
          top: 0; 
          left: 0; 
          width: 100%; 
          height: 100%;
          background: rgba(255, 255, 255, 0.9); 
          backdrop-filter: blur(5px);
          z-index: 10; 
          display: flex; 
          flex-direction: column; 
          align-items: center; 
          justify-content: center; 
          text-align: center; 
          padding: 20px;
        }
        
        .lock-overlay span { 
          font-size: 2.5rem; 
          margin-bottom: 10px; 
        }
        
        .lock-overlay p { 
          font-weight: 700; 
          color: var(--dark); 
          margin-bottom: 15px; 
          font-size: 0.95rem; 
        }
        
        .preview-box {
          background: white; 
          padding: 15px; 
          border-radius: 12px; 
          box-shadow: 0 4px 15px rgba(0,0,0,0.06); 
          margin-bottom: 20px; 
          font-size: 0.85rem; 
          text-align: left; 
          width: 90%; 
          border: 1px solid #efefef;
          line-height: 1.5;
        }

        .upgrade-btn { 
          background: var(--dark); 
          color: white; 
          border: none; 
          padding: 12px 28px; 
          border-radius: 8px; 
          cursor: pointer; 
          font-weight: 700; 
          font-size: 0.9rem;
          transition: var(--transition);
          pointer-events: auto !important;
        }
        
        .upgrade-btn:hover { 
          background: var(--primary); 
          transform: translateY(-2px);
        }

        /* ========================================
           LIVE STATUS INDICATORS
           ========================================
        */
        .op-indicator {
          display: inline-flex;
          align-items: center;
          gap: 6px;
          font-size: 0.75rem;
          color: var(--success);
          font-weight: 700;
          margin-left: 10px;
          text-transform: uppercase;
        }
        
        .pulse-dot {
          width: 8px;
          height: 8px;
          background-color: var(--success);
          border-radius: 50%;
          display: inline-block;
          animation: pulse-green 2s infinite;
        }
        
        @keyframes pulse-green {
          0% { transform: scale(0.95); box-shadow: 0 0 0 0 rgba(40, 167, 69, 0.7); }
          70% { transform: scale(1); box-shadow: 0 0 0 10px rgba(40, 167, 69, 0); }
          100% { transform: scale(0.95); box-shadow: 0 0 0 0 rgba(40, 167, 69, 0); }
        }

        /* ========================================
           LAYOUT COMPONENTS
           ========================================
        */
        .section-header { 
          max-width: 1200px; 
          margin: 50px auto 25px; 
          padding: 0 20px;
          display: flex; 
          align-items: center; 
          gap: 15px;
        }
        
        .section-header h2 { 
          font-size: 1.6rem; 
          font-weight: 700;
          letter-spacing: -0.5px; 
        }
        
        .section-line { 
          flex-grow: 1; 
          height: 1px; 
          background: #ddd; 
        }

        .hero { 
          background: white; 
          padding: 70px 20px; 
          text-align: center; 
          border-bottom: 1px solid var(--border-color); 
          margin-bottom: 30px; 
        }
        
        .hero h1 { 
          font-size: 2.8rem; 
          margin-bottom: 12px; 
          letter-spacing: -1.5px; 
          font-weight: 800;
        }
        
        .hero p { 
          color: #666; 
          max-width: 650px; 
          margin: 0 auto; 
          font-size: 1.1rem;
        }

        .container { 
          max-width: 1200px; 
          margin: 0 auto; 
          padding: 0 20px 80px; 
        }

        .grid { 
          display: grid; 
          grid-template-columns: repeat(auto-fit, minmax(360px, 1fr)); 
          gap: 30px; 
        }

        .tool-card {
          background: white;
          border-radius: var(--card-radius);
          padding: 35px;
          border: 1px solid var(--border-color);
          transition: var(--transition);
          display: flex;
          flex-direction: column;
          justify-content: space-between;
          position: relative;
        }
        
        .tool-card:hover:not(.locked-card) { 
          transform: translateY(-8px); 
          box-shadow: var(--shadow); 
          border-color: var(--primary); 
        }

        .wide-card { 
          grid-column: 1 / -1; 
          display: flex; 
          flex-direction: row; 
          gap: 45px; 
          align-items: flex-start; 
        }
        
        @media (max-width: 900px) { 
          .wide-card { flex-direction: column; } 
        }

        .icon-box {
          width: 55px; 
          height: 55px; 
          background: #fff9e6; 
          color: var(--primary);
          border-radius: 14px; 
          display: flex; 
          align-items: center; 
          justify-content: center;
          font-size: 26px; 
          margin-bottom: 25px;
        }

        h3 { 
          margin-bottom: 12px; 
          font-size: 1.35rem; 
          font-weight: 700;
        }
        
        .tool-description { 
          color: #6c757d; 
          font-size: 0.95rem; 
          margin-bottom: 25px; 
          line-height: 1.5;
        }

        /* ========================================
           FORMS & INTERACTION
           ========================================
        */
        .input-group { margin-bottom: 22px; }
        
        label { 
          display: block; 
          font-size: 0.85rem; 
          font-weight: 700; 
          margin-bottom: 10px; 
          color: var(--dark); 
          text-transform: uppercase;
          letter-spacing: 0.5px;
        }
        
        input, select, textarea { 
          width: 100%; 
          padding: 14px; 
          border: 1px solid #ddd; 
          border-radius: 10px; 
          font-family: inherit; 
          font-size: 1rem; 
          background: #fafafa;
          transition: var(--transition);
        }
        
        input:focus, select:focus, textarea:focus {
          outline: none;
          border-color: var(--primary);
          background: #fff;
          box-shadow: 0 0 0 4px rgba(212, 175, 55, 0.1);
        }
        
        textarea { resize: vertical; min-height: 120px; }

        .btn-save {
          background: var(--primary); 
          color: white; 
          border: none; 
          padding: 15px;
          border-radius: 10px; 
          font-weight: 700; 
          cursor: pointer; 
          width: 100%; 
          font-size: 1rem;
          transition: var(--transition);
          display: flex;
          justify-content: center;
          align-items: center;
          gap: 10px;
        }
        
        .btn-save:hover:not(:disabled) { 
          background: var(--primary-hover); 
          transform: translateY(-2px); 
          box-shadow: 0 5px 15px rgba(212, 175, 55, 0.3);
        }
        
        .btn-save:disabled { 
          background: #cbd5e0; 
          cursor: not-allowed; 
          transform: none;
        }

        /* ========================================
           DATA TABLES
           ========================================
        */
        .data-table-container { 
          background: white; 
          border-radius: 14px; 
          border: 1px solid var(--border-color); 
          overflow: hidden; 
          margin-top: 15px; 
          box-shadow: 0 4px 12px rgba(0,0,0,0.03);
        }
        
        table { width: 100%; border-collapse: collapse; text-align: left; }
        
        th { 
          background: #f8f9fa; 
          padding: 18px; 
          font-size: 0.75rem; 
          text-transform: uppercase; 
          color: #888; 
          border-bottom: 1px solid var(--border-color); 
          font-weight: 700;
          letter-spacing: 1px;
        }
        
        td { 
          padding: 18px; 
          font-size: 0.95rem; 
          border-bottom: 1px solid var(--border-color); 
        }
        
        .role-tag { 
          padding: 5px 12px; 
          border-radius: 6px; 
          font-size: 0.75rem; 
          font-weight: 700; 
        }
        
        .tag-admin { background: #fff3e0; color: #ef6c00; }
        .tag-staff { background: #e8f5e9; color: #2e7d32; }

        /* ========================================
           UTILITY CLASSES
           ========================================
        */
        .switch-group { 
          display: flex; 
          justify-content: space-between; 
          align-items: center; 
          background: #f8f9fa; 
          padding: 16px; 
          border-radius: 10px; 
          margin-bottom: 20px; 
          border: 1px solid #eee;
        }
        
        .switch { 
          position: relative; 
          display: inline-block; 
          width: 48px; 
          height: 26px; 
        }
        
        .switch input { opacity: 0; width: 0; height: 0; }
        
        .slider { 
          position: absolute; 
          cursor: pointer; 
          top: 0; left: 0; right: 0; bottom: 0; 
          background-color: #cbd5e0; 
          transition: .4s; 
          border-radius: 34px; 
        }
        
        .slider:before { 
          position: absolute; 
          content: ""; 
          height: 20px; width: 20px; 
          left: 3px; bottom: 3px; 
          background-color: white; 
          transition: .4s; 
          border-radius: 50%; 
        }
        
        input:checked + .slider { background-color: var(--primary); }
        input:checked + .slider:before { transform: translateX(22px); }

        .status-badge { 
          font-size: 0.7rem; 
          padding: 5px 10px; 
          border-radius: 5px; 
          font-weight: 800; 
          text-transform: uppercase; 
          margin-left: 10px; 
        }
        
        .badge-pro { background: #e3f2fd; color: #0d47a1; }
        .badge-enterprise { background: #f3e5f5; color: #7b1fa2; }
        .badge-active { background: #e8f5e9; color: #2e7d32; border: 1px solid #2e7d32; }

        footer { 
          text-align: center; 
          padding: 60px 20px; 
          color: #999; 
          font-size: 0.95rem; 
          border-top: 1px solid var(--border-color); 
          background: white;
        }

        /* NEW: Business Type Card Styles */
        .business-type-info {
          background: linear-gradient(135deg, #fff9e6 0%, #fff3cd 100%);
          padding: 20px;
          border-radius: 12px;
          border: 1px solid var(--primary);
          margin-top: 15px;
        }
        
        .business-type-info h4 {
          color: var(--dark);
          margin-bottom: 10px;
          font-size: 1rem;
        }
        
        .business-type-info ul {
          margin: 0;
          padding-left: 20px;
          color: #666;
          font-size: 0.9rem;
          line-height: 1.8;
        }
    </style>
</head>
<body>

<nav>
  <div class="nav-container">
    <a href="index.html" class="nav-logo"><span>‚ú®</span> AI Smart Hub</a>
    <div class="nav-links">
      <a href="index.html">Dashboard</a>
      <a href="ai-automations.html">AI Automations</a>
      <a href="#ai-brain-section">AI Brain</a>
      <a href="#org-section">Team</a>
      <a href="customer-insights.html" class="nav-link">Customer Insights</a>
      <a href="index.html" class="back-btn">Exit Center</a>
    </div>
  </div>
</nav>

<div class="hero">
  <h1>AI Intelligence Center</h1>
  <p>Your centralized dashboard for configuring high-performance AI tools and knowledge bases.</p>
  <div id="plan-indicator" style="margin-top:20px; font-weight:800; color:var(--primary); font-size: 0.9rem; letter-spacing: 1px;">
    ACCOUNT STATUS: <span id="currentPlanName" style="background: #fff9e6; padding: 5px 15px; border-radius: 20px; border: 1px solid var(--primary);">DETECTING...</span>
  </div>
</div>

<div class="container">

  <!-- NEW: Business Identity Section -->
  <div class="section-header" id="business-identity-section">
    <h2>üè¢ Business Identity</h2>
    <div class="section-line"></div>
  </div>

  <div class="grid">
    <div class="tool-card wide-card" id="card-business-type">
      <div style="flex: 1;">
        <div class="icon-box">üè¢</div>
        <h3>Business Profile <span class="op-indicator"><span class="pulse-dot"></span> LIVE</span></h3>
        <p class="tool-description">Define your business type and industry so the AI can represent you accurately to customers with appropriate tone and terminology.</p>
        
        <div class="input-group">
          <label>Business Type / Industry</label>
          <select id="businessType">
            <option value="">Select your business type...</option>
            <option value="retail">Retail Store (Clothing, Electronics, etc.)</option>
            <option value="restaurant">Restaurant / Food Service</option>
            <option value="salon">Beauty Salon / Spa</option>
            <option value="consulting">Consulting / Professional Services</option>
            <option value="healthcare">Healthcare / Medical</option>
            <option value="fitness">Fitness / Gym</option>
            <option value="realestate">Real Estate</option>
            <option value="education">Education / Training</option>
            <option value="technology">Technology / SaaS</option>
            <option value="automotive">Automotive / Car Dealership</option>
            <option value="hotel">Hotel / Hospitality</option>
            <option value="legal">Legal Services</option>
            <option value="finance">Financial Services</option>
            <option value="construction">Construction / Home Services</option>
            <option value="other">Other</option>
          </select>
        </div>
        
        <div class="input-group">
          <label>Custom Business Description (Optional)</label>
          <textarea id="businessDescription" rows="3" placeholder="e.g., We sell premium men's formal wear and accessories, specializing in wedding suits and corporate attire..."></textarea>
        </div>
        
        <button class="btn-save" onclick="saveSmartTool('business_type', event)">Save Business Identity</button>
      </div>
      
      <div style="flex: 0.8; background: #fafafa; padding: 25px; border-radius: 14px; border: 1px dashed #ddd;">
        <h3>Why This Matters</h3>
        <div class="business-type-info">
          <h4>When customers chat with your widget, the AI will know:</h4>
          <ul>
            <li>What industry you're in</li>
            <li>Appropriate tone and terminology</li>
            <li>Relevant services to suggest</li>
            <li>How to handle industry-specific questions</li>
            <li>When to escalate to human agents</li>
          </ul>
        </div>
        <p style="font-size: 0.85rem; color: #666; margin-top: 15px; line-height: 1.6;">
          <strong>Example:</strong> A restaurant AI will know about reservations, menu items, and dietary restrictions. A salon AI will understand appointment types, stylist specialties, and beauty services.
        </p>
      </div>
    </div>
  </div>

  <div class="section-header" id="ai-brain-section">
    <h2>üß† AI Knowledge Base</h2>
    <div class="section-line"></div>
  </div>

  <div class="grid">
    <div class="tool-card wide-card" id="card-brain">
      <div style="flex: 1.2;">
        <div class="icon-box">üìñ</div>
        <h3>System Prompt & Identity <span class="op-indicator"><span class="pulse-dot"></span> LIVE</span></h3>
        <p class="tool-description">Define the core personality and operational constraints of your AI agent. This prompt governs every interaction.</p>
        <div class="input-group">
          <label>Global System Instructions</label>
          <textarea id="aiInstructions" rows="10" placeholder="Example: You are a professional support agent for 'Elite Cars'. Your tone is luxury and helpful. Never mention competitors..."></textarea>
        </div>
      </div>
      <div style="flex: 0.8; background: #fafafa; padding: 25px; border-radius: 14px; border: 1px dashed #ddd;">
        <h3>Execution Settings</h3>
        <div class="input-group" style="margin-top: 20px;">
          <label>Creativity (Temperature)</label>
          <select id="aiTemp">
            <option value="0.1">Strict & Technical</option>
            <option value="0.4">Helpful & Direct</option>
            <option value="0.7" selected>Balanced & Conversational</option>
            <option value="1.0">Creative & Marketing Focused</option>
          </select>
        </div>
        <div class="input-group">
          <label>Default Language</label>
          <select id="aiLang">
            <option value="auto">Auto-Detect Multi-language</option>
            <option value="en">Force English</option>
            <option value="es">Force Spanish</option>
            <option value="fr">Force French</option>
          </select>
        </div>
        <button class="btn-save" id="save-brain" onclick="saveSmartTool('brain', event)">Deploy Knowledge Update</button>
      </div>
    </div>
  </div>

  <div class="section-header">
    <h2>üöÄ Enterprise Intelligence</h2>
    <div class="section-line"></div>
  </div>

  <div class="grid">
    <div class="tool-card locked-card" id="card-apollo">
      <div class="lock-overlay" id="overlay-enrichment">
        <div class="preview-box">
          <p><strong>B2B Enrichment Sample:</strong></p>
          <p style="color:var(--success)">‚úì Found: john.doe@company.com</p>
          <p>‚úì Role: VP of Engineering</p>
          <p>‚úì Revenue: $50M - $100M</p>
        </div>
        <p>Unlock Apollo Lead Intelligence</p>
        <button class="upgrade-btn" onclick="window.location.href='dashboard.html'">Upgrade Account</button>
      </div>
      <div>
        <div class="icon-box">üîç</div>
        <h3>Apollo Lead Scraper <span class="status-badge badge-enterprise">Enterprise</span></h3>
        <p class="tool-description">Connect your Apollo API key to automatically enrich every chat lead with professional data.</p>
        <div class="input-group">
            <label>Apollo API Key</label>
            <input type="password" id="apolloKey" placeholder="sk_xxxxxxxxxxxxxxxx">
        </div>
      </div>
      <button class="btn-save" onclick="saveSmartTool('apollo', event)">Connect Apollo API</button>
    </div>

    <div class="tool-card locked-card" id="card-followup">
      <div class="lock-overlay" id="overlay-followup">
        <div class="preview-box">
          <p><strong>Auto-Automation:</strong></p>
          <p>1. User provides email</p>
          <p>2. User goes idle for 5m</p>
          <p style="color:var(--success)">3. AI sends custom follow-up</p>
        </div>
        <p>Unlock Smart Follow-ups</p>
        <button class="upgrade-btn" onclick="window.location.href='dashboard.html'">Upgrade to Pro</button>
      </div>
      <div>
        <div class="icon-box">üìß</div>
        <h3>AI Email Nurture <span class="status-badge badge-pro">Pro</span></h3>
        <p class="tool-description">Automatically sends context-aware follow-up emails if a lead drops off before booking.</p>
        <div class="switch-group">
            <span>Enable Auto-Nurture</span>
            <label class="switch">
              <input type="checkbox" id="followupToggle">
              <span class="slider"></span>
            </label>
        </div>
      </div>
      <button class="btn-save" onclick="saveSmartTool('followup', event)">Activate Automation</button>
    </div>

    <div class="tool-card locked-card" id="card-vision">
        <div class="lock-overlay" id="overlay-vision">
          <div class="preview-box">
            <p><strong>Vision Processing:</strong></p>
            <p style="color:var(--success)">[Image] Invoice_Scan_01.png</p>
            <p><strong>AI Analysis:</strong> <em>"Found Invoice #402. Total: $45.00. Dated: 05/12/26."</em></p>
          </div>
          <p>Unlock Multimodal Vision AI</p>
          <button class="upgrade-btn" onclick="window.location.href='dashboard.html'">Upgrade Account</button>
        </div>
        <div>
          <div class="icon-box">üëÅÔ∏è</div>
          <h3>AI Vision Hub <span class="status-badge badge-enterprise">Enterprise</span></h3>
          <p class="tool-description">Enable GPT-4 Vision capabilities allowing your AI to read screenshots, PDFs, and photos.</p>
          <div class="switch-group">
            <span>Allow Image Uploads</span>
            <label class="switch">
              <input type="checkbox" id="visionToggle">
              <span class="slider"></span>
            </label>
          </div>
        </div>
        <button class="btn-save" onclick="saveSmartTool('vision', event)">Update Vision Settings</button>
      </div>
  </div>

  <div class="section-header">
    <h2>üõ†Ô∏è Operational Tools</h2>
    <div class="section-line"></div>
  </div>

  <div class="grid">
    <div class="tool-card" id="card-booking">
      <div>
        <div class="icon-box">üìÖ</div>
        <h3>Appointment Logic <span class="op-indicator"><span class="pulse-dot"></span> LIVE</span></h3>
        <p class="tool-description">Direct the AI to identify booking intent and present your scheduling link at the perfect moment.</p>
        <div class="input-group">
          <label>Primary Booking Link</label>
          <input type="text" id="bookingUrl" placeholder="https://calendly.com/your-business/meeting">
        </div>
      </div>
      <button class="btn-save" onclick="saveSmartTool('booking', event)">Sync Booking Logic</button>
    </div>

    <div class="tool-card locked-card" id="card-sentiment">
      <div class="lock-overlay" id="overlay-sentiment">
        <span>üö®</span>
        <p>Enterprise Crisis Monitoring</p>
        <button class="upgrade-btn" onclick="window.location.href='dashboard.html'">Upgrade</button>
      </div>
      <div>
        <div class="icon-box">üõ°Ô∏è</div>
        <h3>Crisis Guard <span class="status-badge badge-pro">Enterprise</span></h3>
        <p class="tool-description">Real-time sentiment analysis. If a user gets angry, the AI alerts your team immediately.</p>
        <div class="switch-group">
          <span>Alert on Negative Tone</span>
          <label class="switch">
            <input type="checkbox" id="sentimentToggle">
            <span class="slider"></span>
          </label>
        </div>
        <div class="input-group">
          <label>Emergency Contact Email</label>
          <input type="email" id="alertEmail" placeholder="ops@yourcompany.com">
        </div>
      </div>
      <button class="btn-save" onclick="saveSmartTool('sentiment', event)">Save Security Rules</button>
    </div>

    <div class="tool-card locked-card" id="card-webhook">
      <div class="lock-overlay" id="overlay-webhook">
        <span>üîó</span>
        <p>Pro Data Connectivity</p>
        <button class="upgrade-btn" onclick="window.location.href='dashboard.html'">Upgrade</button>
      </div>
      <div>
        <div class="icon-box">‚ö°</div>
        <h3>CRM Sync (Webhooks) <span class="status-badge badge-pro">Pro</span></h3>
        <p class="tool-description">Push lead data directly to Zapier, HighLevel, or HubSpot via standard POST webhooks.</p>
        <div class="input-group">
          <label>Destination Webhook URL</label>
          <input type="text" id="webhookUrl" placeholder="https://hooks.zapier.com/v1/...">
        </div>
      </div>
      <button class="btn-save" onclick="saveSmartTool('webhook', event)">Save Webhook</button>
    </div>
  </div>

  <div class="section-header" id="org-section">
    <h2>üè¢ Organization & Team</h2>
    <div class="section-line"></div>
  </div>

  <div class="grid">
    <div class="tool-card wide-card">
      <div style="width: 100%;">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px;">
          <div>
            <h3>Staff Permissions <span class="op-indicator"><span class="pulse-dot"></span> LIVE</span></h3>
            <p class="tool-description" style="margin-bottom: 0;">Manage who can access the AI logs and dashboard settings.</p>
          </div>
          <button class="btn-save" style="width: auto; padding: 12px 25px; background: var(--dark);" onclick="openInviteModal()">+ Add Team Member</button>
        </div>

        <div class="data-table-container">
          <table>
            <thead>
              <tr>
                <th>Member</th>
                <th>Email Address</th>
                <th>Role</th>
                <th>Status</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="teamTableBody">
              <tr>
                <td><strong>Current User</strong></td>
                <td id="userEmail">admin@business.io</td>
                <td><span class="role-tag tag-admin">Owner</span></td>
                <td><span style="color: var(--success); font-weight: 700;">‚óè Online</span></td>
                <td>-</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>

  <div class="grid" style="margin-top: 30px;">
    <div class="tool-card" id="card-handover">
      <div>
        <div class="icon-box">üéß</div>
        <h3>Live Handover</h3>
        <p class="tool-description">Define when the AI should step back and hand the conversation to a human agent.</p>
        <div class="input-group">
          <label>Trigger Condition</label>
          <select id="handoverTrigger">
            <option value="human">"Ask for representative"</option>
            <option value="fail">AI fails 3 times</option>
            <option value="complex">High-value lead detected</option>
            <option value="manual">Always Manual</option>
          </select>
        </div>
      </div>
      <button class="btn-save" onclick="saveSmartTool('handover', event)">Set Handover Rules</button>
    </div>

    <div class="tool-card" id="card-analytics">
      <div>
        <div class="icon-box">üìà</div>
        <h3>Reporting Hub</h3>
        <p class="tool-description">Download comprehensive AI performance reports and lead quality analysis in bulk.</p>
        <div style="padding: 15px; background: #f8f9fa; border-radius: 8px; margin-bottom: 20px;">
            <p style="font-size: 0.8rem; color: #666;">Monthly AI Accuracy: <strong>98.2%</strong></p>
            <p style="font-size: 0.8rem; color: #666;">Leads Captured: <strong>1,402</strong></p>
        </div>
      </div>
      <button class="btn-save" style="background: #333;" onclick="exportBusinessData()">Download PDF Report</button>
    </div>
  </div>
</div>

<footer>
  <p>&copy; 2026 AI Smart Business Hub | Advanced Agent Control Panel</p>
</footer>


<!-- Load smart-logic.js separately -->
<script src="smart-logic.js"></script>

<!-- Add this script to handle the booking URL specifically -->
<script>
// Additional fix for booking URL saving
document.addEventListener('DOMContentLoaded', function() {
    console.log("[SMART-TOOLS] Additional fix loaded");
    
    // Make sure saveSmartTool is globally available
    window.saveSmartTool = function(toolType, event) {
        const token = localStorage.getItem('token');
        if (!token) {
            alert("Please log in first");
            return;
        }
        
        const btn = event?.currentTarget || event?.target;
        if (btn) {
            btn.disabled = true;
            btn.innerHTML = '‚è≥ Saving...';
        }
        
        let data = {};
        
        if (toolType === 'booking') {
            data = {
                url: document.getElementById('bookingUrl')?.value || ''
            };
            console.log("[BOOKING] Saving URL:", data.url);
        }
        
        // Call the backend
        fetch(`${window.BACKEND_URL}/api/smart-hub/save`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'Authorization': `Bearer ${token}`
            },
            body: JSON.stringify({ toolType, data })
        })
        .then(res => res.json())
        .then(result => {
            if (result.success) {
                if (btn) {
                    btn.innerHTML = '‚úì Saved';
                    btn.style.background = '#28a745';
                    setTimeout(() => {
                        btn.innerHTML = '‚óè LIVE';
                        btn.classList.add('btn-live-status');
                        btn.disabled = false;
                    }, 1000);
                }
                alert("Booking URL saved successfully!");
            } else {
                throw new Error(result.error || "Save failed");
            }
        })
        .catch(err => {
            console.error("[BOOKING] Error:", err);
            if (btn) {
                btn.innerHTML = '‚ùå Error';
                btn.style.background = '#dc3545';
                setTimeout(() => {
                    btn.innerHTML = 'Sync Booking Logic';
                    btn.style.background = '';
                    btn.disabled = false;
                }, 2000);
            }
            alert("Failed to save: " + err.message);
        });
    };
    
    // Load user email
    const token = localStorage.getItem('token');
    if (token) {
        try {
            const payload = JSON.parse(atob(token.split('.')[1]));
            document.getElementById('userEmail').textContent = payload.email || 'admin@business.io';
        } catch (e) {}
    }
});
</script
</body>
</html>